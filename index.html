<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>防衛線マップ（円陣配置）</title>
<style>
body {
  font-family: sans-serif;
  margin: 0;
  padding: 0;
  background: #f0f4f8;
}
#header-container {
  margin-bottom: 10px;
}
#map {
  position: relative;
  width: 100%;
  height: 80vh;
  background: #e0f7fa;
  overflow: hidden;
}
.base {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  position: absolute;
  text-align: center;
  line-height: 40px;
  color: #fff;
  font-weight: bold;
}
.official { background: #ff5722; }
.user { background: #4caf50; }
#announcements {
  height: 20vh;
  background: #fafafa;
  overflow-y: auto;
  padding: 10px;
  border-top: 1px solid #ccc;
}
.face {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  display: inline-block;
  background: #ffeb3b;
  margin-right: 2px;
  vertical-align: middle;
}
</style>
</head>
<body>

<div id="header-container"></div>
<div id="map"></div>
<div id="announcements"></div>

<script>
// 共通ヘッダー読み込み
fetch("header.html")
  .then(res => res.text())
  .then(html => {
    document.getElementById("header-container").innerHTML = html;
  });

// === 防衛マップ ===
const map = document.getElementById("map");
const announcements = document.getElementById("announcements");

// 中心点
const centerX = window.innerWidth / 2;
const centerY = window.innerHeight * 0.35;

// 学園本部（中央）
const officialBase = { id: "official1", x: centerX - 20, y: centerY - 20, type: "official", name: "学園本部", faces: ["静海", "宝楽"] };
createBase(officialBase);

// ユーザー拠点（円形に配置）
const numBases = 20;
const radius = 250;
for (let i = 0; i < numBases; i++) {
  const angle = (i / numBases) * 2 * Math.PI;
  const x = centerX + radius * Math.cos(angle) - 20;
  const y = centerY + radius * Math.sin(angle) - 20;
  const base = {
    id: "user" + (i + 1),
    x, y,
    type: "user",
    name: "拠点" + (i + 1),
    faces: []
  };
  createBase(base);
}

// === 関数 ===
function createBase(b) {
  const div = document.createElement("div");
  div.className = "base " + b.type;
  div.style.left = b.x + "px";
  div.style.top = b.y + "px";
  div.textContent = b.name[0];
  b.faces.forEach(f => {
    const fdiv = document.createElement("span");
    fdiv.className = "face";
    fdiv.title = f;
    div.appendChild(fdiv);
  });
  map.appendChild(div);
}

// === アナウンス ===
const logs = [
  "防衛線起動 — 各拠点、戦闘準備を開始！",
  "北東拠点に敵影確認！",
  "学園本部、防衛魔術展開完了！"
];
logs.forEach(l => {
  const p = document.createElement("p");
  p.textContent = l;
  announcements.appendChild(p);
});
</script>

</body>
</html>
