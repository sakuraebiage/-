<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>é˜²è¡›æˆ¦ãƒ¢ãƒƒã‚¯</title>
<style>
  body { font-family: sans-serif; margin:0; display:flex; flex-direction:column; height:100vh; }
  #map { flex:1; position:relative; background:#eef; border:1px solid #ccc; margin:10px; border-radius:10px; }
  .base { width:50px; height:50px; border-radius:50%; position:absolute; text-align:center; line-height:50px; color:white; font-weight:bold; }
  .green { background:green; }
  .yellow { background:gold; color:black; }
  .red { background:red; }
  .fire { background:orange; }
  .face { width:30px; height:30px; border-radius:50%; background:#fff; display:inline-block; vertical-align:middle; margin-left:2px; }
  #log { height:120px; overflow-y:auto; background:#222; color:#fff; padding:5px; font-size:14px; }
  #chat { height:100px; overflow-y:auto; background:#333; color:#fff; padding:5px; font-size:14px; }
  #chat input { width:80%; }
  #chat button { width:18%; }
</style>
</head>
<body>

<div id="map"></div>
<div id="log">æˆ¦æ³ã‚¢ãƒŠã‚¦ãƒ³ã‚¹...</div>
<div id="chat">
  <div id="chat-messages"></div>
  <input type="text" id="chat-input" placeholder="ç™ºè¨€...">
  <button onclick="sendChat()">é€ä¿¡</button>
</div>

<script>
const map = document.getElementById('map');
const log = document.getElementById('log');
const chatMessages = document.getElementById('chat-messages');

// 20æ‹ ç‚¹æƒ…å ±
const bases = [];
for(let i=0;i<20;i++){
  bases.push({name:'æ‹ ç‚¹'+(i+1), angle:i*18, status:'green', face:'ğŸ˜€'});
}

// ãƒãƒƒãƒ—ã«é…ç½®
function renderMap(){
  map.innerHTML = '';
  const cx = map.clientWidth/2;
  const cy = map.clientHeight/2;
  const r = Math.min(cx, cy)-50;
  bases.forEach(b=>{
    const rad = b.angle*Math.PI/180;
    const x = cx + r*Math.cos(rad) -25;
    const y = cy + r*Math.sin(rad) -25;
    const div = document.createElement('div');
    div.className = 'base '+b.status;
    div.style.left = x+'px';
    div.style.top = y+'px';
    div.innerHTML = b.name+'<div class="face">'+b.face+'</div>';
    map.appendChild(div);
  });
}

// æˆ¦æ³æ›´æ–°ï¼ˆç°¡æ˜“ãƒ©ãƒ³ãƒ€ãƒ ï¼‰
function updateStatus(){
  bases.forEach(b=>{
    const r = Math.random();
    if(r<0.1) b.status='fire';
    else if(r<0.3) b.status='red';
    else if(r<0.6) b.status='yellow';
    else b.status='green';
  });
  renderMap();
  log.innerHTML = 'é˜²è¡›æˆ¦æ›´æ–°ï¼\n' + bases.map(b=>b.name+':'+b.status).join(' | ');
}

// ãƒãƒ£ãƒƒãƒˆé€ä¿¡
function sendChat(){
  const val = document.getElementById('chat-input').value;
  if(!val) return;
  const msg = document.createElement('div');
  msg.textContent = 'ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼: '+val;
  chatMessages.appendChild(msg);
  chatMessages.scrollTop = chatMessages.scrollHeight;
  document.getElementById('chat-input').value='';
}

// åˆæœŸè¡¨ç¤º
renderMap();

// 5ç§’ã”ã¨ã«æˆ¦æ³æ›´æ–°
setInterval(updateStatus,5000);

</script>
</body>
</html>
