<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>戦闘設定 - PC用</title>
<style>
body { margin:0; font-family:"Consolas","Roboto Mono",monospace; background:#000; color:#e0e0e0; }
header { background:#111; padding:10px 20px; text-align:center; border-bottom:1px solid #444; }
header h1 { color:#8ae1ff; }
#container { display:flex; flex-direction:column; padding:10px; }
#pc-list { display:flex; flex-wrap:wrap; margin-top:10px; }
.pc-card { width:180px; background:#111; margin:5px; padding:8px; border:1px solid #8ae1ff; border-radius:6px; cursor:pointer; }
.pc-card.selected { border-color:#ff4b4b; }
label { display:block; margin:4px 0; font-size:0.9em; }
input, select, textarea { width:100%; margin-bottom:4px; background:#222; border:1px solid #444; color:#e0e0e0; border-radius:3px; padding:2px; }
button { margin-top:5px; padding:6px; background:#111; border:1px solid #8ae1ff; color:#8ae1ff; cursor:pointer; }
button:hover { background:#8ae1ff; color:#000; }
</style>
</head>
<body>

<div id="header-container"></div>
<script src="../common/header.js"></script>
<script>
  fetch("../common/header.html")
    .then(res => res.text())
    .then(html => {
      document.getElementById("header-container").innerHTML = html;
    });
</script>


<div id="container">
  <h3>キャラクター一覧</h3>
  <div id="pc-list"></div>

  <h3>選択中キャラクター設定</h3>
  <div id="pc-settings">
    <label>HP: <input type="number" id="hp" min="0" max="9999"></label>
    <label>SP: <input type="number" id="sp" min="0" max="999"></label>
    <label>MP: <input type="number" id="mp" min="0" max="999"></label>
    <label>前列/後列: 
      <select id="row-position">
        <option value="front">前列</option>
        <option value="back">後列</option>
      </select>
    </label>
    <label>スキル一覧: 
      <select id="skill-list" multiple size="5"></select>
    </label>
    <label>セリフ: <textarea id="dialogue" rows="3"></textarea></label>
    <label>カットイン: <input type="text" id="cutin" placeholder="画像URL"></label>
    <label>アイコン: <input type="text" id="icon" placeholder="画像URL"></label>
    <button id="saveBtn">保存</button>
  </div>
</div>

<script>
// サンプルPC
const pcs = [
  {name:"十束静海", hp:1000, sp:200, mp:150, row:"front", skills:["炎神覇斬","炎の壁"], dialogue:"", cutin:"", icon:""},
  {name:"萩月恵佳", hp:900, sp:250, mp:300, row:"back", skills:["アイシクル","水流連撃"], dialogue:"", cutin:"", icon:""}
];

// サンプルスキル
const allSkills = ["炎神覇斬","炎の壁","アイシクル","水流連撃","風刃","氷結弾","光輝治癒","蘇生の祈り"];

const pcListDiv = document.getElementById("pc-list");
const skillSelect = document.getElementById("skill-list");
const hpInput = document.getElementById("hp");
const spInput = document.getElementById("sp");
const mpInput = document.getElementById("mp");
const rowSelect = document.getElementById("row-position");
const dialogueInput = document.getElementById("dialogue");
const cutinInput = document.getElementById("cutin");
const iconInput = document.getElementById("icon");
const saveBtn = document.getElementById("saveBtn");

let selectedPC = null;

// PC一覧表示
function renderPCList(){
  pcListDiv.innerHTML = "";
  pcs.forEach((pc,i)=>{
    const div = document.createElement("div");
    div.classList.add("pc-card");
    if(selectedPC === i) div.classList.add("selected");
    div.textContent = pc.name;
    div.onclick = ()=>{ selectPC(i); };
    pcListDiv.appendChild(div);
  });
}

// PC選択
function selectPC(index){
  selectedPC = index;
  renderPCList();
  const pc = pcs[index];
  hpInput.value = pc.hp;
  spInput.value = pc.sp;
  mpInput.value = pc.mp;
  rowSelect.value = pc.row;
  dialogueInput.value = pc.dialogue;
  cutinInput.value = pc.cutin;
  iconInput.value = pc.icon;

  // スキル表示
  skillSelect.innerHTML = "";
  allSkills.forEach(skill=>{
    const option = document.createElement("option");
    option.value = skill;
    option.textContent = skill;
    if(pc.skills.includes(skill)) option.selected = true;
    skillSelect.appendChild(option);
  });
}

// 保存
saveBtn.onclick = ()=>{
  if(selectedPC === null) return;
  const pc = pcs[selectedPC];
  pc.hp = parseInt(hpInput.value);
  pc.sp = parseInt(spInput.value);
  pc.mp = parseInt(mpInput.value);
  pc.row = rowSelect.value;
  pc.dialogue = dialogueInput.value;
  pc.cutin = cutinInput.value;
  pc.icon = iconInput.value;
  pc.skills = Array.from(skillSelect.selectedOptions).map(o=>o.value);
  alert(pc.name + " の設定を保存しました！");
}

renderPCList();
</script>
</body>
</html>
