<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>開発者用ステータス＆スキル編集</title>
<style>
body {
  margin:0;
  font-family:"Consolas","Roboto Mono",monospace;
  background:#000;
  color:#e0e0e0;
}
header {
  background:#111;
  padding:10px 20px;
  border-bottom:1px solid #444;
  text-align:center;
}
header h1 { color:#8ae1ff; }

.container { display:flex; padding:10px; gap:20px; }

#char-list, #char-edit { flex:1; background:#111; padding:10px; border:1px solid #444; border-radius:8px; max-height:80vh; overflow-y:auto; }

.char-item { padding:5px; border-bottom:1px solid #333; cursor:pointer; }
.char-item:hover { background:#222; }

input, select { background:#222; border:1px solid #8ae1ff; color:#e0e0e0; padding:3px; margin:2px 0; width:100%; }
button { padding:5px 10px; margin-top:5px; cursor:pointer; background:#111; border:1px solid #8ae1ff; color:#8ae1ff; }
button:hover { background:#8ae1ff; color:#000; }
</style>
</head>
<body>
<header>
  <h1>開発者用キャラクター＆スキル編集</h1>
</header>

<div class="container">
  <div id="char-list">
    <h3>キャラクター一覧</h3>
    <!-- キャラをここに挿入 -->
  </div>

  <div id="char-edit">
    <h3>編集</h3>
    <div id="edit-fields">
      <p>キャラクターを選択してください</p>
    </div>
    <button id="save-btn">保存</button>
  </div>
</div>

<script>
// ======== サンプルキャラクター ========
let characters = JSON.parse(localStorage.getItem("devCharacters")) || [
  {name:"十束静海", hp:1000, sp:200, mp:150, atk:100, def:80, skills:[
    {name:"炎神覇斬", power:90, targets:"敵全体", effects:["裂傷"], condition:"なし"},
    {name:"炎の壁", power:0, targets:"自己", effects:["防御上昇","カウンター"], condition:"なし"}
  ]},
  {name:"萩月恵佳", hp:800, sp:250, mp:200, atk:60, def:50, skills:[]}
];

// ======== キャラクターリスト表示 ========
const charListDiv = document.getElementById("char-list");
const editFieldsDiv = document.getElementById("edit-fields");
let selectedChar = null;

function renderCharList() {
  charListDiv.innerHTML = "<h3>キャラクター一覧</h3>";
  characters.forEach((c,i)=>{
    const div = document.createElement("div");
    div.classList.add("char-item");
    div.textContent = c.name;
    div.onclick = ()=>selectChar(i);
    charListDiv.appendChild(div);
  });
}

// ======== 編集フォーム作成 ========
function selectChar(index) {
  selectedChar = characters[index];
  editFieldsDiv.innerHTML = `
    <label>名前:<input type="text" id="char-name" value="${selectedChar.name}"></label>
    <label>HP:<input type="number" id="char-hp" value="${selectedChar.hp}"></label>
    <label>SP:<input type="number" id="char-sp" value="${selectedChar.sp}"></label>
    <label>MP:<input type="number" id="char-mp" value="${selectedChar.mp}"></label>
    <label>攻撃:<input type="number" id="char-atk" value="${selectedChar.atk}"></label>
    <label>防御:<input type="number" id="char-def" value="${selectedChar.def}"></label>
    <h4>スキル編集</h4>
    <div id="skills-container"></div>
    <button id="add-skill-btn">スキル追加</button>
  `;
  renderSkills();
}

// ======== スキルフォーム ========
function renderSkills() {
  const skillsDiv = document.getElementById("skills-container");
  skillsDiv.innerHTML = "";
  selectedChar.skills.forEach((s,i)=>{
    const div = document.createElement("div");
    div.style.border="1px solid #444"; div.style.margin="3px"; div.style.padding="3px";
    div.innerHTML = `
      <label>名前:<input type="text" class="skill-name" value="${s.name}"></label>
      <label>威力:<input type="number" class="skill-power" value="${s.power}"></label>
      <label>対象:<input type="text" class="skill-targets" value="${s.targets}"></label>
      <label>効果:<input type="text" class="skill-effects" value="${s.effects.join(",")}"></label>
      <label>発動条件:<input type="text" class="skill-condition" value="${s.condition}"></label>
      <button class="remove-skill">削除</button>
    `;
    div.querySelector(".remove-skill").onclick = ()=>{
      selectedChar.skills.splice(i,1);
      renderSkills();
    }
    skillsDiv.appendChild(div);
  });
}

// ======== スキル追加 ========
document.getElementById("add-skill-btn")?.addEventListener("click", ()=>{
  selectedChar.skills.push({name:"新規スキル", power:0, targets:"敵単体", effects:[], condition:"なし"});
  renderSkills();
});

// ======== 保存 ========
document.getElementById("save-btn").onclick = ()=>{
  // 編集内容を反映
  selectedChar.name = document.getElementById("char-name").value;
  selectedChar.hp = parseInt(document.getElementById("char-hp").value);
  selectedChar.sp = parseInt(document.getElementById("char-sp").value);
  selectedChar.mp = parseInt(document.getElementById("char-mp").value);
  selectedChar.atk = parseInt(document.getElementById("char-atk").value);
  selectedChar.def = parseInt(document.getElementById("char-def").value);

  // スキル反映
  const skillDivs = document.querySelectorAll("#skills-container > div");
  skillDivs.forEach((div,i)=>{
    const name = div.querySelector(".skill-name").value;
    const power = parseFloat(div.querySelector(".skill-power").value);
    const targets = div.querySelector(".skill-targets").value;
    const effects = div.querySelector(".skill-effects").value.split(",").map(s=>s.trim()).filter(Boolean);
    const condition = div.querySelector(".skill-condition").value;
    selectedChar.skills[i] = {name,power,targets,effects,condition};
  });

  localStorage.setItem("devCharacters", JSON.stringify(characters));
  alert("保存しました！");
  renderCharList();
}

// ======== 初期描画 ========
renderCharList();
</script>
</body>
</html>

