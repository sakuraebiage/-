<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>マイページ</title>
<style>
body { font-family:"Roboto","Consolas",monospace; background:#000; color:#fff; padding:20px; }
input, button { margin:5px; padding:5px; }
button { cursor:pointer; background:#111; border:1px solid #8ae1ff; color:#8ae1ff; }
button:hover { background:#8ae1ff; color:#000; }
</style>
</head>
<body>
<h1>マイページ</h1>
<label>キャラ選択:
  <select id="charSelect"></select>
</label><br>
<label>アイコン (120x120):
  <input type="file" id="iconFile">
</label><br>
<label>立ち絵 (700x800):
  <input type="file" id="spriteFile">
</label><br>
<button id="saveBtn">保存</button>
<button onclick="window.location.href='index.html'">トップへ戻る</button>

<script>
const select = document.getElementById("charSelect");
let chars = JSON.parse(localStorage.getItem("characters")||"[]");
chars.forEach((c,i)=>select.add(new Option(c.name,i)));

document.getElementById("saveBtn").addEventListener("click",()=>{
  const c = chars[select.value];
  const icon = document.getElementById("iconFile").files[0];
  const sprite = document.getElementById("spriteFile").files[0];

  if(icon){ const reader = new FileReader(); reader.onload=e=>{ c.icon=e.target.result; localStorage.setItem("characters", JSON.stringify(chars)); }; reader.readAsDataURL(icon);}
  if(sprite){ const reader = new FileReader(); reader.onload=e=>{ c.sprite=e.target.result; localStorage.setItem("characters", JSON.stringify(chars)); }; reader.readAsDataURL(sprite);}

  alert("保存しました！");
});
</script>
</body>
</html>
