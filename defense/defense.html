<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>防衛戦マップ</title>
<style>
body { font-family: sans-serif; margin: 0; padding: 0; }
#map { position: relative; width: 100%; height: 80vh; background: #e0f7fa; }
.base { width: 40px; height: 40px; border-radius: 50%; position: absolute; text-align: center; line-height: 40px; color: #fff; font-weight: bold; }
.official { background: #ff5722; }
.user { background: #4caf50; }
.arrow { position: absolute; width: 2px; background: black; transform-origin: top left; }
#announcements { height: 20vh; background: #fafafa; overflow-y: auto; padding: 10px; border-top: 1px solid #ccc; }
.face { width: 20px; height: 20px; border-radius: 50%; display: inline-block; background: #ffeb3b; margin-right: 2px; vertical-align: middle; }
</style>
</head>
<body>

<h1>防衛戦マップ</h1>
<a href="../index.html">トップに戻る</a>

<div id="map"></div>
<div id="announcements"></div>

<script>
const map = document.getElementById('map');
const announcements = document.getElementById('announcements');

// 拠点円陣データ（メイン円陣用）
const centerX = 400, centerY = 300, radius = 150;
const numBases = 20;
const bases = [];

// 円陣生成
for(let i=0;i<numBases;i++){
  const angle = 2*Math.PI/numBases*i;
  const x = centerX + radius * Math.cos(angle);
  const y = centerY + radius * Math.sin(angle);
  bases.push({id:'b'+i, x, y, type:'user', name:'拠点'+(i+1), faces:['A'+i]} );
}

// マップに拠点配置
bases.forEach(b => {
  const div = document.createElement('div');
  div.className = 'base ' + b.type;
  div.style.left = (b.x-20) + 'px';
  div.style.top = (b.y-20) + 'px';
  div.innerHTML = b.name[0];
  b.faces.forEach(f=>{
    const fdiv = document.createElement('span');
    fdiv.className = 'face';
    fdiv.title = f;
    div.appendChild(fdiv);
  });
  map.appendChild(div);
});

// 簡易アナウンス
const logs = [
  '防衛戦開始！',
  '拠点の残存HP: 全部100%'
];
function updateLogs(){
  announcements.innerHTML = '';
  logs.forEach(l=>{
    const p = document.createElement('p');
    p.textContent = l;
    announcements.appendChild(p);
  });
}
updateLogs();

// 1時間ごと更新（テスト用は10秒にしてもOK）
setInterval(updateLogs, 3600000);
</script>

</body>
</html>
