<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>é˜²è¡›æˆ¦ãƒãƒƒãƒ—</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Orbitron', sans-serif;
  margin: 0;
  background: radial-gradient(circle at center, #0b0f17 40%, #03050a 100%);
  color: #ccc;
  overflow: hidden;
}
#header {
  position: absolute;
  top: 10px;
  right: 20px;
  z-index: 100;
}
#header button {
  background: #222;
  color: #0ff;
  border: 1px solid #0ff;
  padding: 6px 12px;
  font-family: 'Orbitron', sans-serif;
  font-size: 14px;
  cursor: pointer;
  border-radius: 4px;
  transition: 0.3s;
}
#header button:hover {
  background: #0ff;
  color: #000;
}

#map {
  position: relative;
  width: 100%;
  height: 85vh;
}
.base {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  position: absolute;
  text-align: center;
  line-height: 50px;
  font-weight: bold;
  color: white;
  box-shadow: 0 0 10px rgba(255,255,255,0.3);
  transition: transform 0.3s ease;
}
.base:hover {
  transform: scale(1.2);
}
.official {
  background: #ff5722;
  box-shadow: 0 0 15px #ff5722;
}
.user {
  background: #2196f3;
  box-shadow: 0 0 10px #2196f3;
}

#announcements {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 60px;
  background: rgba(10, 10, 20, 0.85);
  overflow: hidden;
  display: flex;
  align-items: center;
  color: #ccc;
  font-size: 14px;
  border-top: 1px solid #333;
}
#scroll-text {
  position: relative;
  white-space: nowrap;
  animation: scrollText 20s linear infinite;
  padding-left: 100%;
  filter: brightness(0.7);
}
@keyframes scrollText {
  0% { transform: translateX(100%); }
  45% { transform: translateX(0); }
  55% { transform: translateX(0); }
  100% { transform: translateX(-100%); }
}

/* æ‹ ç‚¹æƒ…å ±ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— */
#infoBox {
  position: absolute;
  background: rgba(20,20,30,0.95);
  color: #0ff;
  padding: 12px;
  border: 1px solid #0ff;
  border-radius: 8px;
  display: none;
  z-index: 50;
  font-size: 13px;
  min-width: 180px;
}
</style>
</head>
<body>

<div id="header">
  <button onclick="window.location.href='index.html'">ğŸ  ãƒ¡ã‚¤ãƒ³ã¸æˆ»ã‚‹</button>
</div>

<div id="map"></div>
<div id="infoBox"></div>

<div id="announcements">
  <div id="scroll-text">æˆ¦æ³ã‚¢ãƒŠã‚¦ãƒ³ã‚¹èµ·å‹•ä¸­â€¦</div>
</div>

<script>
const map = document.getElementById("map");
const infoBox = document.getElementById("infoBox");

// === æ‹ ç‚¹ç”Ÿæˆ ===
const centerX = window.innerWidth / 2;
const centerY = window.innerHeight / 2 + 100;
const radius = 250;

const bases = [];
bases.push({id: "official", x: centerX, y: centerY, name: "å­¦åœ’æœ¬éƒ¨", type: "official", hp: 100});

for (let i = 1; i <= 19; i++) {
  const angle = (i / 19) * 2 * Math.PI;
  const offsetX = (Math.cos(angle) * radius) + centerX + (Math.random() * 40 - 20);
  const offsetY = (Math.sin(angle) * radius) + centerY + (Math.random() * 40 - 20);
  bases.push({id: `user${i}`, x: offsetX, y: offsetY, name: `æ‹ ç‚¹${i}`, type: "user", hp: Math.floor(Math.random() * 100)});
}

// === è¡¨ç¤º ===
bases.forEach(b => {
  const div = document.createElement("div");
  div.className = "base " + b.type;
  div.style.left = b.x + "px";
  div.style.top = b.y + "px";
  div.textContent = b.name === "å­¦åœ’æœ¬éƒ¨" ? "æœ¬éƒ¨" : b.name.replace("æ‹ ç‚¹", "");
  
  div.addEventListener("click", e => {
    showInfo(b, e.pageX, e.pageY);
  });
  
  map.appendChild(div);
});

// === æ‹ ç‚¹ã‚¯ãƒªãƒƒã‚¯ã§æƒ…å ±è¡¨ç¤º ===
function showInfo(b, x, y) {
  infoBox.style.left = x + "px";
  infoBox.style.top = y + "px";
  infoBox.innerHTML = `
    <strong>${b.name}</strong><br>
    è€ä¹…å€¤: ${b.hp}%<br>
    çŠ¶æ…‹: ${b.hp <= 0 ? "é™¥è½" : b.hp < 30 ? "å±é™º" : b.hp < 100 ? "äº¤æˆ¦ä¸­" : "å®‰å®š"}<br>
    <hr>
    <button onclick="alert('æˆ¦é—˜ç”»é¢ï¼ˆä»®ï¼‰ã‚’é–‹ãã¾ã™')">âš”ï¸ æˆ¦é—˜ã¸</button>
  `;
  infoBox.style.display = "block";
}

// === æˆ¦æ³ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ ===
const scrollText = document.getElementById("scroll-text");
function updateAnnouncements() {
  const critical = bases.filter(b => b.hp < 30 && b.hp > 0);
  const stable = bases.filter(b => b.hp >= 30 && b.hp < 100);
  const safe = bases.filter(b => b.hp === 100);

  let text = "";
  if (critical.length > 0) {
    const c = critical[Math.floor(Math.random() * critical.length)];
    text = `${c.name}ï¼šè€ä¹…${c.hp}%ï¼æ•‘æ´ã‚’æ±‚ã‚ã¦ã„ã¾ã™ï¼`;
  } else if (stable.length > 0) {
    const s = stable[Math.floor(Math.random() * stable.length)];
    text = `${s.name}ï¼šæˆ¦é—˜ç¶™ç¶šä¸­ã€è¢«å®³è»½å¾®ã€‚`;
  } else if (safe.length > 0) {
    const s = safe[Math.floor(Math.random() * safe.length)];
    text = `${s.name}ï¼šé˜²è¡›å®Œäº†ã€ã‚¨ãƒªã‚¢å®‰å®šåŒ–ï¼`;
  } else {
    text = "å…¨æ‹ ç‚¹ã®ãƒ‡ãƒ¼ã‚¿æ›´æ–°ä¸­...";
  }
  scrollText.textContent = text;
}

// åˆå›ï¼‹1æ™‚é–“ã”ã¨æ›´æ–°
updateAnnouncements();
setInterval(updateAnnouncements, 3600000);
</script>
</body>
</html>
